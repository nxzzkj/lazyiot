
/*
 * Vendor: Frozen Mountain Software
 * Title: FM Core for JavaScript
 * Version: 2.0.0.6
 * Copyright Â© Frozen Mountain Software 2011+
 */

window.fm||(window.fm={});var __bind=function(e,t){return function(){return e.apply(t,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},JSON;JSON||(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSONFM=="function"&&(a=a.toJSONFM(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSONFM!="function"&&(Date.prototype.toJSONFM=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSONFM=Number.prototype.toJSONFM=Boolean.prototype.toJSONFM=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),fm.util=function(){function t(){}var e=this;return t.name="util",t._xdCache={},t.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.isPlainObject=function(e){var t,n;if(!e||Object.prototype.toString.call(e)!=="[object Object]"||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!Object.prototype.hasOwnProperty.call(e,"constructor")&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(t in e)n=0;return t===void 0||Object.prototype.hasOwnProperty.call(e,t)},t.canAttachProperties=function(e,t){var n,r,i,s;for(n in t){s=t[n],i="set"+n.charAt(0).toUpperCase()+n.substring(1),r=e[i];if(!r||Object.prototype.toString.call(r)!=="[object Function]")return!1}return!0},t.attachProperties=function(e,t){var n,r,i,s,o;o=[];for(n in t)s=t[n],i="set"+n.charAt(0).toUpperCase()+n.substring(1),r=e[i],o.push(r.call(e,s));return o},t.isIE=function(){return!!document.protocol},t.isIE6=function(){return t.isIE()&&!window.XMLHttpRequest},t.isIE7=function(){return t.isIE()&&window.XMLHttpRequest&&!document.implementation},t.isIE8=function(){return t.isIE()&&document.implementation&&document.implementation.hasFeature&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},t.isIE9=function(){return t.isIE()&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},t.isXD=function(e,n){var r,i,s,o;return n?(i=t.getHost(e),s=t.getHost(n),t.compareHost(i,s)):(t._xdCache[e]||(r=t.getHost(e),o=t.getHost(),t._xdCache[e]=t.compareHost(r,o)?"y":"n"),t._xdCache[e]==="y")},t.getHost=function(e){var n;return e?(n=t.parseUrl(e),n.protocol?n:t.getCurrentHost()):t.getCurrentHost()},t.compareHost=function(e,t){return e.server!==t.server||(e.port||t.port)&&e.port!==t.port},t.getCurrentHost=function(){var e;return e=document.location,{protocol:e.protocol,server:e.hostname,port:e.port}},t.parseUrl=function(e){var t;t=/((https?:)\/\/)?([\-\w\.\*]+)+(:(\d+))?(\/([^\?]*(\?\S+)?)?)?/i.exec(e);if(t.length<6)throw new Error("Invalid URL ("+e+").");return{prefix:t[1],protocol:t[2],server:t[3],postfix:t[4],port:t[5],path:t[6]}},t.absolutizeUrl=function(e){var n,r,i;return e?(i=t.parseUrl(e),i.protocol?i.server.indexOf("*")===-1?e:(e=i.prefix+t.wildcard(i.server),i.postfix&&(e+=i.postfix),i.path&&(e+=i.path),e):(r=document.location,n=r.protocol+"//"+r.host,e.charAt(0)==="/"?n+e:n+r.pathname.substring(0,r.pathname.lastIndexOf("/")+1)+e)):e},t.wildcard=function(e){return e.replace("*",t.getWildcard())},t._chars="abcdefghijklmnopqrstuvwxyz",t.getWildcard=function(){return t._wildcard||(t._wildcard=t.randomChar(t._chars)),t._wildcard},t.randomChar=function(e){return e?e.charAt(Math.floor(Math.random()*e.length)):e},t.observe=function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},t.unobserve=function(e,t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},t.extend=function(e,t){var n;for(n in t)e[n]=t[n];return e},t.logging=!0,t.log=function(e){var n;if(!t.logging)return;if(!document.body){t.addOnLoad(function(){return t.log(e)});return}return t._logContainer||(t._logContainer=document.createElement("div"),t._logContainer.className="fm-log",t._logContainer.style.position="absolute",t._logContainer.style.zIndex=99999,t._logContainer.style.right="5px",t._logContainer.style.top="5px",document.body.appendChild(t._logContainer)),n=document.createElement("div"),n.innerHTML=e,t._logContainer.appendChild(n)},t._loadFunctions=[],t.addOnLoad=function(e){return t._readyRun?window.setTimeout(e,1):t._loadFunctions.push(e)},t.ready=function(){if(t._readyRun)return;return t._readyRun=!0,window.setTimeout(function(){var e,n,r,i,s;i=t._loadFunctions,s=[];for(n=0,r=i.length;n<r;n++)e=i[n],s.push(e());return s},1)},t.bindReady=function(){var e;if(t._readyBound)return;t._readyBound=!0;if(document.addEventListener)return document.addEventListener("DOMContentLoaded",function(){return document.removeEventListener("DOMContentLoaded",arguments.callee,!1),t.ready()},!1);if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete")return document.detachEvent("onreadystatechange",arguments.callee),t.ready()});try{e=window.frameElement===null}catch(n){}if(document.documentElement.doScroll&&e)return function(){if(t._loaded)return;try{document.documentElement.doScroll("left")}catch(e){window.setTimeout(arguments.callee,0);return}return t.ready()}()}},t._loaded||t.addOnLoad(function(){return t._loaded=!0}),t.bindReady(),t}.call(this),fm.object=function(){function e(){}return e.name="object",e}(),fm.global=function(){function e(){}return e.name="global",e.tryCast=function(e,t){return!e||e instanceof t?e:null},e.tryCastArray=function(e){return!e||e instanceof Array?e:null},e.tryCastObject=function(e){return!e||e instanceof Object?e:null},e.tryCastString=function(e){if(!e||typeof e=="string")return e},e.tryCastInt=function(e){return!e||!isNaN(parseInt(e))?e:null},e.tryCastFloat=function(e){return!e||!isNaN(parseFloat(e))?e:null},e}.call(this),fm.stringComparison={CurrentCulture:0,CurrentCultureIgnoreCase:1,InvariantCulture:2,InvariantCultureIgnoreCase:3,Ordinal:4,OrdinalIgnoreCase:5};var __bind=function(e,t){return function(){return e.apply(t,arguments)}};fm.dateTime=function(){function e(){this.getSecond=__bind(this.getSecond,this),this.getMinute=__bind(this.getMinute,this),this.getHour=__bind(this.getHour,this),this.getDay=__bind(this.getDay,this),this.getMonth=__bind(this.getMonth,this),this.getYear=__bind(this.getYear,this),this.toUniversalTime=__bind(this.toUniversalTime,this),this.getTicks=__bind(this.getTicks,this);var e,t,n,r,i,s;if(arguments.length===1)this._date=arguments[0];else{if(arguments.length!==6)throw new Error("Unknown argument set.");s=arguments[0],r=arguments[1],e=arguments[2],t=arguments[3],n=arguments[4],i=arguments[5],this._date=new Date(Date.UTC(s,r-1,e,t,n,i))}}return e.name="dateTime",e.getNow=function(){return new fm.dateTime(new Date)},e.getUtcNow=function(){return new fm.dateTime(new Date)},e.prototype.getTicks=function(){return 621355968e9+this._date.getTime()*1e4},e.prototype.toUniversalTime=function(){return new fm.dateTime(this._date)},e.prototype.getYear=function(){return this._date.getUTCFullYear()},e.prototype.getMonth=function(){return this._date.getUTCMonth()+1},e.prototype.getDay=function(){return this._date.getUTCDate()},e.prototype.getHour=function(){return this._date.getUTCHours()},e.prototype.getMinute=function(){return this._date.getUTCMinutes()},e.prototype.getSecond=function(){return this._date.getUTCSeconds()},e}.call(this);var __bind=function(e,t){return function(){return e.apply(t,arguments)}};fm.nameValueCollection=function(){function e(){this.getAllKeys=__bind(this.getAllKeys,this),this.getKeys=__bind(this.getKeys,this);var e,t,n;this._value={};if(arguments.length===1){n=arguments[0];for(e in n)t=n[e],this._value[e]=t}}return e.name="nameValueCollection",e.prototype.source=function(){return this._value},e.prototype.get=function(e){var t;for(t in this._value)if(t.toLowerCase()===e.toLowerCase())return this._value[t];return null},e.prototype.set=function(e,t){var n;for(n in this._value)if(n.toLowerCase()===e.toLowerCase()){this._value[n]=t;return}return this._value[e]=t},e.prototype.getCount=function(){var e,t;e=0;for(t in this._value)e++;return e},e.prototype.toHash=function(){return this._value},e.prototype.getKeys=function(){return this.getAllKeys()},e.prototype.getAllKeys=function(){var e,t;t=[];for(e in this._value)t.push(e);return t},e}(),fm.stringBuilder=function(){function e(){this._value="",arguments.length===1&&(this._value=arguments[0])}return e.name="stringBuilder",e.prototype.append=function(e){return this._value=this._value+e,this},e.prototype.toString=function(){return this._value},e.prototype.getLength=function(){return this._value.length},e.prototype.remove=function(e,t){return this._value=this._value.substring(0,e)+this._value.substring(e+t),this},e}(),fm.uri=function(){function e(){}return e.name="uri",e.tryCreate=function(e,t,n){return n.setValue(e),!0},e.tryCreate=function(e,t,n){return e.indexOf("/",e.length-"/".length)===-1&&(e+="/"),t.indexOf("/")===0&&(t=t.substring(1)),n.setValue(e+t),!0},e.escapeDataString=function(e){return encodeURIComponent(e)},e}(),fm.guid=function(){function e(){arguments.length===0?this._guid="00000000-0000-0000-0000-000000000000":this._guid=arguments[0]}return e.name="guid",e.prototype.equals=function(e){return e.toString()===this._guid},e.prototype.toString=function(){return this._guid},e.empty=new e,e}(),fm.holder=function(){function e(e){this._value=e}return e.name="holder",e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){return this._value=e},e}(),fm.interlocked=function(){function e(){}return e.name="interlocked",e.increment=function(e){var t;return t=e.getValue(),t++,e.setValue(t),t},e.compareExchange=function(e,t,n){var r;return r=e.getValue(),r===n&&e.setValue(t),r},e}(),fm.delegate=function(){function e(){}return e.name="delegate",e.combine=function(e,t){var n,r,i,s,o,u,a,f,l,c;if(!e)return t;if(!t)return e;s=this,n=[],i=function(){var e,t,r,i;i=[];for(t=0,r=n.length;t<r;t++)e=n[t],i.push(e.apply(s,arguments));return i};if(e._chain){l=e._chain;for(o=0,a=l.length;o<a;o++)r=l[o],n.push(r)}else n.push(e);if(t._chain){c=t._chain;for(u=0,f=c.length;u<f;u++)r=c[u],n.push(r)}else n.push(t);return i._chain=n,i},e.remove=function(e,t){var n,r,i,s,o;if(!e||e===t)return null;if(e._chain){o=e._chain;for(r=i=0,s=o.length;i<s;r=++i){n=o[r];if(n===t){e._chain.splice(r,1);break}}}return e},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};fm.stack=function(){function e(){this.peek=__bind(this.peek,this),this.pop=__bind(this.pop,this),this.push=__bind(this.push,this),this._list=[]}return e.name="stack",e.prototype.push=function(e){return this._list.push(e)},e.prototype.pop=function(e){return this._list.pop()},e.prototype.peek=function(){return this._list.length===0?null:this._list[this._list.length-1]},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};fm.thread=function(){function e(){this.getManagedThreadId=__bind(this.getManagedThreadId,this),this._id=++fm.thread._lastThreadId}return e.name="thread",e._lastThreadId=0,e.prototype.getManagedThreadId=function(){return this._id},e.getCurrentThread=function(){return e._thread||(e._thread=new fm.thread),e._thread},e}.call(this),fm.deferrer=function(){function e(){}return e.name="deferrer",e.defer=function(e,t,n){var r=this;return window.setTimeout(function(){return e(n)},t)},e}(),fm.dateTimeStyles={AssumeUniversal:1,AdjustToUniversal:2},fm.dateTimeFormatInfo=function(){function e(){}return e.name="dateTimeFormatInfo",e.getInvariantInfo=function(){return new fm.dateTimeFormatInfo},e}.call(this),fm.convert=function(){function e(){}return e.name="convert",e.toInt32=function(e){return e.charCodeAt()},e}.call(this),fm.parseAssistant=function(){function e(){}return e.name="parseAssistant",e.tryParseInteger=function(e,t){return isNaN(parseInt(e))?!1:(t.setValue(parseInt(e)),!0)},e.tryParseLong=function(e,t){return isNaN(parseInt(e))?!1:(t.setValue(parseInt(e)),!0)},e.tryParseFloat=function(e,t){return isNaN(parseFloat(e))?!1:(t.setValue(parseFloat(e)),!0)},e.tryParseDouble=function(e,t){return isNaN(parseFloat(e))?!1:(t.setValue(parseFloat(e)),!0)},e.tryParseDecimal=function(e,t){return isNaN(parseFloat(e))?!1:(t.setValue(parseFloat(e)),!0)},e.tryParseBoolean=function(e,t){return e.toLowerCase()==="true"||e.toLowerCase()==="y"||e==="1"?t.setValue(!0):t.setValue(!1),!0},e.tryParseGuid=function(e,t){return/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i.test(e)?(t.setValue(new fm.guid(e)),!0):!1},e}.call(this),fm.stringExtensions=function(){function e(){}return e.name="stringExtensions",e.empty="",e.concat=function(e){var t,n,r,i;t=new fm.stringBuilder;for(r=0,i=e.length;r<i;r++)n=e[r],t.append(n);return t.toString()},e.toString=function(){return arguments[0]},e.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},e.concat=function(){var e,t,n,r,i,s,o;e="";if(arguments.length===1&&fm.util.isArray(arguments[0])){o=arguments[0];for(n=0,i=o.length;n<i;n++)t=o[n],e+=t}else for(r=0,s=arguments.length;r<s;r++)t=arguments[r],e+=t;return e},e.join=function(e,t){var n,r,i,s,o;r=new fm.stringBuilder;for(n=s=0,o=t.length;s<o;n=++s)i=t[n],n>0&&r.append(e),r.append(i);return r.toString()},e.split=function(e,t){var n,r,i,s,o,u,a,f;i=[],s=0;for(r=o=0,f=e.length-1;0<=f?o<=f:o>=f;r=0<=f?++o:--o)for(u=0,a=t.length;u<a;u++)n=t[u],n===e.charAt(r)&&(i.push(e.substring(s,r)),s=r+1);return i.push(e.substring(s,e.length)),i},e.isNullOrEmpty=function(e){return e===null||e===""},e.indexOf=function(){var e,t,n;t=arguments[0],e=arguments[1];if(arguments.length>2){n=arguments[2];if(n===fm.stringComparison.CurrentCultureIgnoreCase||n===fm.stringComparison.InvariantCultureIgnoreCase||n===fm.stringComparison.OrdinalIgnoreCase)return t.toLowerCase().indexOf(e.toLowerCase())}return t.indexOf(e)},e.startsWith=function(){var e,t,n;t=arguments[0],e=arguments[1];if(arguments.length>2){n=arguments[2];if(n===fm.stringComparison.CurrentCultureIgnoreCase||n===fm.stringComparison.InvariantCultureIgnoreCase||n===fm.stringComparison.OrdinalIgnoreCase)return t.toLowerCase().indexOf(e.toLowerCase())===0}return t.indexOf(e)===0},e.format=function(){var e,t,n,r,i,s;t=arguments[0],e=[];for(r=i=1,s=arguments.length-1;1<=s?i<=s:i>=s;r=1<=s?++i:--i)e.push(arguments[r]);return n=function(t,n){return e[n]!=null?e[n]:t},t.replace(/{(\d+)}/g,n)},e.toLower=function(){return arguments[0].toLowerCase()},e.getLength=function(){return arguments[0].length},e.getChars=function(e){var t,n,r,i;t=[];for(n=r=0,i=e.length-1;0<=i?r<=i:r>=i;n=0<=i?++r:--r)t.push(e[n]);return new t},e.substring=function(e,t,n){return e.substring(t,t+n)},e}.call(this),fm.arrayExtensions=function(){function e(){}return e.name="arrayExtensions",e.getCount=function(e){return e.length},e.add=function(e,t){return e.push(t)},e.remove=function(e,t){var n,r,i,s;for(n=i=0,s=e.length;i<s;n=++i){r=e[n];if(r===t)return e.splice(n,1),!0}return!1},e.toArray=function(e){return e},e.clear=function(e){return e.splice(0,e.length)},e.addRange=function(e,t){var n,r,i,s;s=[];for(r=0,i=t.length;r<i;r++)n=t[r],s.push(e.push(n));return s},e.contains=function(e,t){var n,r,i;for(r=0,i=e.length;r<i;r++){n=e[r];if(n===t)return!0}return!1},e}.call(this),fm.hashExtensions=function(){function e(){}return e.name="hashExtensions",e.getCount=function(e){var t,n;t=0;for(n in e)t++;return t},e.getKeys=function(e){var t,n;n=[];for(t in e)n.push(t);return n},e.getValues=function(e){var t,n,r;r=[];for(t in e)n=e[t],r.push(n);return r},e.tryGetValue=function(t,n,r){return e.containsKey(t,n)?(r.setValue(t[n]),!0):!1},e.containsKey=function(e,t){return t in e?!0:!1},e.containsValue=function(e,t){var n,r;for(n in e){r=e[n];if(r===t)return!0}return!1},e.add=function(e,t,n){return e[t]=n},e.remove=function(e,t){return delete e[t]},e.clear=function(e){var t,n;n=[];for(t in e)n.push(delete e[t]);return n},e}.call(this),fm.intExtensions=function(){function e(){}return e.name="intExtensions",e.toString=function(){return arguments[0].toString()},e}(),fm.xhr=function(){function t(){}var e=this;return t.name="xhr",t._count=0,t._current={},fm.util.observe(window,"unload",function(){var e,n,r,i;r=t._current,i=[];for(e in r){n=r[e];try{n._abortingOnUnload=!0,i.push(n.abort())}catch(s){}}return i}),t.failureHandler=function(e,t){if(e.onFailure)return e.onFailure({message:t})},t.successHandler=function(e,t){var n,r,i,s,o,u,a,f,l;if(e.onSuccess){r={},n=t.getAllResponseHeaders();if(n){l=n.split(/\r?\n/);for(a=0,f=l.length;a<f;a++){i=l[a],o=i.split(":");if(o.length!==2)continue;s=o[0].replace(/\s+$/,""),u=o[1].replace(/^\s+/,""),r[s]=u}return e.onSuccess({content:t.responseText,statusCode:t.status,headers:r})}return e.onSuccess({content:t.responseText,statusCode:t.status,headers:{}})}},t.handler=function(e,n){return n._aborting?t.failureHandler(e,"XHR request timed out."):(e.onResponseReceived&&e.onResponseReceived(n),t.successHandler(e,n))},t.send=function(e){var n,r,i,s,o,u;e=fm.util.extend({sync:!1,url:"",method:"POST",content:null,headers:{},timeout:15e3,abortOnUnload:!1,onRequestCreated:function(){},onResponseReceived:function(){},onFailure:function(){},onSuccess:function(){}},e||{});try{if(window.XMLHttpRequest)s=new XMLHttpRequest;else{try{s=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){}if(!s)try{s=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}if(!s)return!1;s.open(e.method,e.url,!e.sync),u=e.headers;for(r in u)i=u[r],r.toLowerCase()!=="referer"&&r.toLowerCase()!=="origin"&&s.setRequestHeader(r,i);return"withCredentials"in s&&(s.withCredentials=!0),e.onRequestCreated&&e.onRequestCreated(s),e.abortOnUnload&&(n=++t._count,t._current[n]=s),e.sync||(s.onreadystatechange=function(){if(s.readyState>3&&!s._abortingOnUnload){clearTimeout(o);try{s.onreadystatechange=null}catch(r){s.onreadystatechange=function(){}}t.handler(e,s);if(e.abortOnUnload)return delete t._current[n]}}),e.content?s.send(e.content):s.send(),o=window.setTimeout(function(){try{return s._aborting=!0,s.abort()}catch(e){}},e.timeout),e.sync&&(t.handler(e,s),e.abortOnUnload&&delete t._xhrCurrent[n]),!0}catch(f){return t.failureHandler(e,"XHR request failed. "+f.message||f.error||f.description||f)}},t}.call(this),fm.postMessage=function(){function e(){}return e.name="postMessage",e._cache={},e.createFrame=function(t,n){var r,i,s,o,u;return u=e._cache[t.url],u?u.frame.loading?u.callbacks.push(n):window.setTimeout(function(){return u.frame.loaded?n(u.frame):n(null)},1):(s=document.createElement("iframe"),s.style.display="none",document.body.appendChild(s),i=[n],e._cache[t.url]=u={frame:s,callbacks:i},o=window.setTimeout(function(){var e;s.loading=!1,s.loaded=!1,s.timedOut=!0,e=[];while(i.length>0)e.push(i.shift()(null));return e},t.timeout),r=null,s.loading=!0,fm.util.observe(s,"load",function(){var n,r;if(s.timedOut)return;return clearTimeout(o),r=function(o){if(o.source===s.contentWindow&&o.data==="pong"){if(s.timedOut)return;clearTimeout(n),s.loading=!1,s.loaded=!0,s.timedOut=!1,e.listen(t,s);while(i.length>0)i.shift()(s);return fm.util.unobserve(window,"message",r)}},n=window.setTimeout(function(){s.loading=!1,s.loaded=!1,s.timedOut=!0;while(i.length>0)i.shift()(null);if(r)return fm.util.unobserve(window,"message",r)},500),fm.util.observe(window,"message",r),s.contentWindow.postMessage("ping",e.getOrigin(t.url))}),s.src=fm.httpTransfer.addQueryToUrl(t.url,"type","pmf"))},e._optionsCounter=0,e._optionsCache={},e.getOrigin=function(e){return/\w+:\/\/[^/]+/.exec(e)[0]},e.send=function(t){return t=fm.util.extend({url:"",onFailure:function(){},onSuccess:function(){},onRequestCreated:function(){},onResponseReceived:function(){}},t||{}),e.createFrame(t,function(n){if(n)return t.id=++e._optionsCounter,e._optionsCache[t.id]=t,n.contentWindow.postMessage(fm.json.serialize(t),e.getOrigin(t.url));if(t.onFailure)return t.onFailure({message:"Could not initialize postMessage frame."})})},e.listen=function(t,n){return fm.util.observe(window,"message",function(r){if(r.source===n.contentWindow){try{r=fm.json.deserialize(r.data)}catch(i){return}if(!r.id)return;t=e._optionsCache[r.id];if(!t)return;(r.type===1||r.type===2)&&delete e._optionsCache[r.id];if(r.type===1){if(t.onFailure)return t.onFailure(r)}else if(r.type===2){if(t.onSuccess)return t.onSuccess(r)}else if(r.type===3){if(t.onRequestCreated)return t.onRequestCreated(null)}else if(r.type===4&&t.onResponseReceived)return t.onResponseReceived(null)}})},e}.call(this),fm.jsonp=function(){function e(){}return e.name="jsonp",e.send=function(e){},e._scriptFrame=null,e._scriptFrameLoaded=!1,e._callbackCount=0,e._cb={},e._pastScriptFrames=[],e._scriptFrameDestroyer=null,e.maxUrlLength=2048,e.getNextCallback=function(t){var n,r;return n="cb"+e._callbackCount++,r="fm.jsonp._cb.",e._cb[n]=function(i){var s;try{t.onResponseReceived&&t.onResponseReceived(null);if(t.onSuccess)return t.robustResponse?(s=i[t.contentParameterName],t.onSuccess({content:s?fm.json.serialize(s):"",statusCode:i[t.statusCodeParameterName]||200,headers:i[t.headersParameterName]||{}})):t.onSuccess({content:fm.json.serialize(i),statusCode:200,headers:{}})}catch(o){throw o}finally{e.cleanup((t.useFrame?"parent.":"")+r+n,t.useFrame)}},(t.useFrame?"parent.":"")+r+n},e.failureHandler=function(e,t){if(e.onFailure)return e.onFailure({message:t})},e.send=function(t){var n,r,i,s;try{return t=fm.util.extend({url:"",method:"POST",content:null,headers:{},timeout:15e3,canSegmentJsonArray:!1,robustResponse:!1,callbackParameterName:"jsonp",contentParameterName:"content",methodParameterName:"method",headersParameterName:"headers",statusCodeParameterName:"statusCode",cacheBusterParameterName:"_cb",onRequestCreated:function(){},onResponseReceived:function(){},onFailure:function(){},onSuccess:function(){}},t||{}),t.useFrame=!0,t.useFrame&&(e._scriptFrameDestroyer||(e._scriptFrameDestroyer=window.setInterval(function(){var t,n,r,i;if(e._scriptFrame!==null){e._pastScriptFrames.push(e._scriptFrame),e._scriptFrame=null,e._scriptFrameLoaded=!1;if(e._pastScriptFrames.length===2){i=e._pastScriptFrames[0];for(n=0,r=i.length;n<r;n++)t=i[n],delete e._pastScriptFrames[0][t];return document.body.removeChild(e._pastScriptFrames[0]),e._pastScriptFrames.splice(0,1)}}},3e5))),r=document.getElementsByTagName("head")[0],t.useFrame?(e._scriptFrame||(e._scriptFrame=document.createElement("iframe"),e._scriptFrame.style.display="none",e._scriptFrame.src="ignore_this_404.htm",document.body.appendChild(e._scriptFrame)),i=e._scriptFrame.contentWindow.document.createElement("script")):i=document.createElement("script"),n=e.getNextCallback(t),i.type="text/javascript",i.charset="utf-8",i.id=n,s=t.url,s=fm.httpTransfer.addQueryToUrl(s,t.methodParameterName,t.method),s=fm.httpTransfer.addQueryToUrl(s,t.headersParameterName,fm.json.serialize(t.headers)),s=fm.httpTransfer.addQueryToUrl(s,t.callbackParameterName,n),s=fm.httpTransfer.addQueryToUrl(s,t.cacheBusterParameterName,(new Date).getTime()),s=fm.httpTransfer.addQueryToUrl(s,t.contentParameterName,t.content),s.length>e.maxUrlLength&&alert("URL length "+s.length+" exceeds maximum for JSON-P ("+e.maxUrlLength+")."),i.src=s,t.onRequestCreated&&t.onRequestCreated(null),window.setTimeout(function(){return e.callbackExists(n)&&e.failureHandler(t,"JSONP request timed out."),e.cleanup(n,t.useFrame)},t.timeout),t.useFrame?e._scriptFrameLoaded?(r=e._scriptFrame.contentWindow.document.body,r.appendChild(i)):fm.util.observe(e._scriptFrame,"load",function(){return window.setTimeout(function(){return r=e._scriptFrame.contentWindow.document.body,r.appendChild(i)},10),e._scriptFrameLoaded=!0}):r.appendChild(i)}catch(o){return e.failureHandler(t,"JSONP request failed. "+o.message||o.error||o.description||o)}},e.cleanup=function(t,n){var r,i,s,o,u,a,f,l;o=t.split("."),s=o[o.length-1],e._cb[s]=null,delete e._cb[s];try{if(n){a=e._pastScriptFrames.concat([]),e._scriptFrame!==null&&a.push(e._scriptFrame);for(i=f=l=a.length-1;l<=0?f<=0:f>=0;i=l<=0?++f:--f){r=a[i].contentWindow.document,u=r.getElementById(t);if(u)break}if(u)return r.body.removeChild(u)}else{u=document.getElementById(t);if(u)return document.getElementsByTagName("head")[0].removeChild(u)}}catch(c){if(window&&window.console&&window.console.error)return window.console.error(c)}},e.callbackExists=function(t){var n,r;return r=t.split("."),n=r[r.length-1],n in e._cb},e}.call(this),fm.json=function(){function e(){}return e.name="json",e._dateRegex=/\/Date\((\d+[\-|\+]?\d{0,4})\)\//,e._reviver=function(e,t){var n,r,i,s;return t&&typeof t=="string"&&dateRegex.test(t)?(s=t.match(dateRegex)[1],n=s.indexOf("-")>-1?"-":"+",r=s.split(n),i=parseInt(r[0],10),new Date(i)):t},Date.prototype.toJSONFM=function(e){return isFinite(this.valueOf())?"/Date("+this.getTime()+"-0000)/":null},e.deserialize=function(){return arguments.length===0||arguments[0]===null||arguments[0]===""?null:JSON.parse.apply(e,arguments)},e.serialize=function(){var e,t,n,r,i;return t=Date.prototype.toJSON,i=String.prototype.toJSON,r=Number.prototype.toJSON,e=Boolean.prototype.toJSON,Date.prototype.toJSON=Date.prototype.toJSONFM,String.prototype.toJSON=String.prototype.toJSONFM,Number.prototype.toJSON=Number.prototype.toJSONFM,Boolean.prototype.toJSON=Boolean.prototype.toJSONFM,n=JSON.stringify.apply(n,arguments).replace(/\//g,"\\/"),Date.prototype.toJSON=t,String.prototype.toJSON=i,Number.prototype.toJSON=r,Boolean.prototype.toJSON=e,n},e}.call(this),fm.logLevel={Debug:1,Info:2,Warn:3,Error:4,Fatal:5},fm.httpMethod={Get:1,Post:2,Put:3,Delete:4},fm.stringType={None:1,Single:2,Double:3},fm.jsonCheckerMode={Array:1,Done:2,Key:3,Object:4,String:5},fm.backoffMode={Additive:1,Constant:2,None:3},fm.httpSendStartArgs=function(e){function t(){this.setSender=__bind(this.setSender,this),this.setRequestTextContent=__bind(this.setRequestTextContent,this),this.setRequestBinaryContent=__bind(this.setRequestBinaryContent,this),this.getSender=__bind(this.getSender,this),this.getRequestTextContent=__bind(this.getRequestTextContent,this),this.getRequestBinaryContent=__bind(this.getRequestBinaryContent,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="httpSendStartArgs",t.prototype._requestBinaryContent=null,t.prototype._requestTextContent=null,t.prototype._sender=null,t.prototype.getRequestBinaryContent=function(){if(arguments.length===0)return this._requestBinaryContent},t.prototype.getRequestTextContent=function(){if(arguments.length===0)return this._requestTextContent},t.prototype.getSender=function(){if(arguments.length===0)return this._sender},t.prototype.setRequestBinaryContent=function(){var e;arguments.length===1&&(e=arguments[0],this._requestBinaryContent=e)},t.prototype.setRequestTextContent=function(){var e;arguments.length===1&&(e=arguments[0],this._requestTextContent=e)},t.prototype.setSender=function(){var e;arguments.length===1&&(e=arguments[0],this._sender=e)},t}(fm.object),fm.serializable=function(e){function t(){this.setSerialized=__bind(this.setSerialized,this),this.setIsSerialized=__bind(this.setIsSerialized,this),this.setIsDirty=__bind(this.setIsDirty,this),this.getSerialized=__bind(this.getSerialized,this),this.getIsSerialized=__bind(this.getIsSerialized,this),this.getIsDirty=__bind(this.getIsDirty,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this),this.setIsSerialized(!1),this.setIsDirty(!1);return}}return __extends(t,e),t.name="serializable",t.prototype.__serialized=null,t.prototype._isDirty=!1,t.prototype._isSerialized=!1,t.prototype.getIsDirty=function(){if(arguments.length===0)return this._isDirty},t.prototype.getIsSerialized=function(){if(arguments.length===0)return this._isSerialized},t.prototype.getSerialized=function(){if(arguments.length===0)return this.__serialized},t.prototype.setIsDirty=function(){var e;arguments.length===1&&(e=arguments[0],this._isDirty=e)},t.prototype.setIsSerialized=function(){var e;arguments.length===1&&(e=arguments[0],this._isSerialized=e)},t.prototype.setSerialized=function(){var e;arguments.length===1&&(e=arguments[0],this.__serialized=e,this.setIsSerialized(!0),this.setIsDirty(!1))},t}(fm.object),fm.dynamic=function(e){function t(){this.unsetDynamicValue=__bind(this.unsetDynamicValue,this),this.setDynamicValue=__bind(this.setDynamicValue,this),this.setDynamicProperties=__bind(this.setDynamicProperties,this),this.getDynamicValue=__bind(this.getDynamicValue,this),this.getDynamicProperties=__bind(this.getDynamicProperties,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this),this.__dynamicProperties={};return}}return __extends(t,e),t.name="dynamic",t.prototype.__dynamicProperties=null,t.prototype.getDynamicProperties=function(){if(arguments.length===0)return this.__dynamicProperties},t.prototype.getDynamicValue=function(){var e,t,n,r;if(arguments.length===1)return e=arguments[0],t=null,n=new fm.holder(t),r=fm.hashExtensions.tryGetValue(this.getDynamicProperties(),e,n),t=n.getValue(),r?t:null},t.prototype.setDynamicProperties=function(){var e;arguments.length===1&&(e=arguments[0],this.__dynamicProperties=e!=null?e:{})},t.prototype.setDynamicValue=function(){var e,t;arguments.length===2&&(e=arguments[0],t=arguments[1],this.getDynamicProperties()[e]=t)},t.prototype.unsetDynamicValue=function(){var e;if(arguments.length===1)return e=arguments[0],fm.hashExtensions.remove(this.getDynamicProperties(),e)},t}(fm.serializable),fm.httpRequestArgs=function(e){function t(){this.setUrl=__bind(this.setUrl,this),this.setTimeout=__bind(this.setTimeout,this),this.setTextContent=__bind(this.setTextContent,this),this.setSender=__bind(this.setSender,this),this.setOnResponseReceived=__bind(this.setOnResponseReceived,this),this.setOnRequestCreated=__bind(this.setOnRequestCreated,this),this.setMethod=__bind(this.setMethod,this),this.setHeaders=__bind(this.setHeaders,this),this.setBinaryContent=__bind(this.setBinaryContent,this),this.getUrl=__bind(this.getUrl,this),this.getTimeout=__bind(this.getTimeout,this),this.getTextContent=__bind(this.getTextContent,this),this.getSender=__bind(this.getSender,this),this.getOnResponseReceived=__bind(this.getOnResponseReceived,this),this.getOnRequestCreated=__bind(this.getOnRequestCreated,this),this.getMethod=__bind(this.getMethod,this),this.getHeaders=__bind(this.getHeaders,this),this.getBinaryContent=__bind(this.getBinaryContent,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this),this.setTimeout(15e3),this.setMethod(fm.httpMethod.Post),this.setHeaders(new fm.nameValueCollection);return}}return __extends(t,e),t.name="httpRequestArgs",t.prototype._binaryContent=null,t.prototype._headers=null,t.prototype._method=null,t.prototype._onRequestCreated=null,t.prototype._onResponseReceived=null,t.prototype._sender=null,t.prototype._textContent=null,t.prototype._timeout=0,t.prototype._url=null,t.prototype.getBinaryContent=function(){if(arguments.length===0)return this._binaryContent},t.prototype.getHeaders=function(){if(arguments.length===0)return this._headers},t.prototype.getMethod=function(){if(arguments.length===0)return this._method},t.prototype.getOnRequestCreated=function(){if(arguments.length===0)return this._onRequestCreated},t.prototype.getOnResponseReceived=function(){if(arguments.length===0)return this._onResponseReceived},t.prototype.getSender=function(){if(arguments.length===0)return this._sender},t.prototype.getTextContent=function(){if(arguments.length===0)return this._textContent},t.prototype.getTimeout=function(){if(arguments.length===0)return this._timeout},t.prototype.getUrl=function(){if(arguments.length===0)return this._url},t.prototype.setBinaryContent=function(){var e;arguments.length===1&&(e=arguments[0],this._binaryContent=e)},t.prototype.setHeaders=function(){var e;arguments.length===1&&(e=arguments[0],this._headers=e)},t.prototype.setMethod=function(){var e;arguments.length===1&&(e=arguments[0],this._method=e)},t.prototype.setOnRequestCreated=function(){var e;arguments.length===1&&(e=arguments[0],this._onRequestCreated=e)},t.prototype.setOnResponseReceived=function(){var e;arguments.length===1&&(e=arguments[0],this._onResponseReceived=e)},t.prototype.setSender=function(){var e;arguments.length===1&&(e=arguments[0],this._sender=e)},t.prototype.setTextContent=function(){var e;arguments.length===1&&(e=arguments[0],this._textContent=e)},t.prototype.setTimeout=function(){var e;arguments.length===1&&(e=arguments[0],this._timeout=e)},t.prototype.setUrl=function(){var e;arguments.length===1&&(e=arguments[0],this._url=e)},t}(fm.dynamic),fm.sort=function(e){function t(){if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="sort",t.partition=function(){var e,t,n,r,i,s,o,u;if(arguments.length===5){e=arguments[0],r=arguments[1],u=arguments[2],o=arguments[3],t=arguments[4],i=e[o],fm.sort.swap(e,o,u),s=r,n=r;while(n<u)t(e[n],i)&&(fm.sort.swap(e,n,s),s++),n++;return fm.sort.swap(e,s,u),s}},t.quickSort=function(){var e,t,n,r,i,s;if(arguments.length===2){e=arguments[0],t=arguments[1],fm.sort.quickSort(e,0,e.length-1,t);return}arguments.length===4&&(e=arguments[0],n=arguments[1],s=arguments[2],t=arguments[3],n<s&&(i=n+(s-n)/2,r=fm.sort.partition(e,n,s,i,t),fm.sort.quickSort(e,n,r-1,t),fm.sort.quickSort(e,r+1,s,t)))},t.swap=function(){var e,t,n,r;arguments.length===3&&(e=arguments[0],n=arguments[1],r=arguments[2],t=e[n],e[n]=e[r],e[r]=t)},t}.call(this,fm.object),fm.httpTransferFactory=function(e){function t(){if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="httpTransferFactory",t._createHttpTransfer=null,t.defaultCreateHttpTransfer=function(){if(arguments.length===0)return new fm.httpWebRequestTransfer},t.getCreateHttpTransfer=function(){if(arguments.length===0)return fm.httpTransferFactory._createHttpTransfer},t.getHttpTransfer=function(){var e,n,r;if(arguments.length===0){n=fm.httpTransferFactory.getCreateHttpTransfer(),(n===null||typeof n=="undefined")&&t.setCreateHttpTransfer(t.defaultCreateHttpTransfer),e=fm.httpTransferFactory.getCreateHttpTransfer()(),r=e;if(r===null||typeof r=="undefined")e=fm.httpTransferFactory.defaultCreateHttpTransfer();return e}},t.setCreateHttpTransfer=function(){var e;arguments.length===1&&(e=arguments[0],t._createHttpTransfer=e)},t}.call(this,fm.object),fm.httpSendFinishArgs=function(e){function t(){this.setSender=__bind(this.setSender,this),this.setResponseTextContent=__bind(this.setResponseTextContent,this),this.setResponseHeaders=__bind(this.setResponseHeaders,this),this.setResponseBinaryContent=__bind(this.setResponseBinaryContent,this),this.setRequestTextContent=__bind(this.setRequestTextContent,this),this.setRequestBinaryContent=__bind(this.setRequestBinaryContent,this),this.getSender=__bind(this.getSender,this),this.getResponseTextContent=__bind(this.getResponseTextContent,this),this.getResponseHeaders=__bind(this.getResponseHeaders,this),this.getResponseBinaryContent=__bind(this.getResponseBinaryContent,this),this.getRequestTextContent=__bind(this.getRequestTextContent,this),this.getRequestBinaryContent=__bind(this.getRequestBinaryContent,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="httpSendFinishArgs",t.prototype._requestBinaryContent=null,t.prototype._requestTextContent=null,t.prototype._responseBinaryContent=null,t.prototype._responseHeaders=null,t.prototype._responseTextContent=null,t.prototype._sender=null,t.prototype.getRequestBinaryContent=function(){if(arguments.length===0)return this._requestBinaryContent},t.prototype.getRequestTextContent=function(){if(arguments.length===0)return this._requestTextContent},t.prototype.getResponseBinaryContent=function(){if(arguments.length===0)return this._responseBinaryContent},t.prototype.getResponseHeaders=function(){if(arguments.length===0)return this._responseHeaders},t.prototype.getResponseTextContent=function(){if(arguments.length===0)return this._responseTextContent},t.prototype.getSender=function(){if(arguments.length===0)return this._sender},t.prototype.setRequestBinaryContent=function(){var e;arguments.length===1&&(e=arguments[0],this._requestBinaryContent=e)},t.prototype.setRequestTextContent=function(){var e;arguments.length===1&&(e=arguments[0],this._requestTextContent=e)},t.prototype.setResponseBinaryContent=function(){var e;arguments.length===1&&(e=arguments[0],this._responseBinaryContent=e)},t.prototype.setResponseHeaders=function(){var e;arguments.length===1&&(e=arguments[0],this._responseHeaders=e)},t.prototype.setResponseTextContent=function(){var e;arguments.length===1&&(e=arguments[0],this._responseTextContent=e)},t.prototype.setSender=function(){var e;arguments.length===1&&(e=arguments[0],this._sender=e)},t}(fm.object),fm.httpResponseArgs=function(e){function t(){this.setTextContent=__bind(this.setTextContent,this),this.setStatusCode=__bind(this.setStatusCode,this),this.setRequestArgs=__bind(this.setRequestArgs,this),this.setHeaders=__bind(this.setHeaders,this),this.setException=__bind(this.setException,this),this.setBinaryContent=__bind(this.setBinaryContent,this),this.getTextContent=__bind(this.getTextContent,this),this.getStatusCode=__bind(this.getStatusCode,this),this.getRequestArgs=__bind(this.getRequestArgs,this),this.getHeaders=__bind(this.getHeaders,this),this.getException=__bind(this.getException,this),this.getBinaryContent=__bind(this.getBinaryContent,this);var e;if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===1){e=arguments[0],t.__super__.constructor.call(this),this.setRequestArgs(e),this.setHeaders(new fm.nameValueCollection);return}}return __extends(t,e),t.name="httpResponseArgs",t.prototype._binaryContent=null,t.prototype._exception=null,t.prototype._headers=null,t.prototype._requestArgs=null,t.prototype._statusCode=0,t.prototype._textContent=null,t.prototype.getBinaryContent=function(){if(arguments.length===0)return this._binaryContent},t.prototype.getException=function(){if(arguments.length===0)return this._exception},t.prototype.getHeaders=function(){if(arguments.length===0)return this._headers},t.prototype.getRequestArgs=function(){if(arguments.length===0)return this._requestArgs},t.prototype.getStatusCode=function(){if(arguments.length===0)return this._statusCode},t.prototype.getTextContent=function(){if(arguments.length===0)return this._textContent},t.prototype.setBinaryContent=function(){var e;arguments.length===1&&(e=arguments[0],this._binaryContent=e)},t.prototype.setException=function(){var e;arguments.length===1&&(e=arguments[0],this._exception=e)},t.prototype.setHeaders=function(){var e;arguments.length===1&&(e=arguments[0],this._headers=e)},t.prototype.setRequestArgs=function(){var e;arguments.length===1&&(e=arguments[0],this._requestArgs=e)},t.prototype.setStatusCode=function(){var e;arguments.length===1&&(e=arguments[0],this._statusCode=e)},t.prototype.setTextContent=function(){var e;arguments.length===1&&(e=arguments[0],this._textContent=e)},t}(fm.object),fm.logProvider=function(e){function t(){this.warnFormat=__bind(this.warnFormat,this),this.warn=__bind(this.warn,this),this.log=__bind(this.log,this),this.isEnabled=__bind(this.isEnabled,this),this.infoFormat=__bind(this.infoFormat,this),this.info=__bind(this.info,this),this.getIsWarnEnabled=__bind(this.getIsWarnEnabled,this),this.getIsInfoEnabled=__bind(this.getIsInfoEnabled,this),this.getIsFatalEnabled=__bind(this.getIsFatalEnabled,this),this.getIsErrorEnabled=__bind(this.getIsErrorEnabled,this),this.getIsDebugEnabled=__bind(this.getIsDebugEnabled,this),this.fatalFormat=__bind(this.fatalFormat,this),this.fatal=__bind(this.fatal,this),this.errorFormat=__bind(this.errorFormat,this),this.error=__bind(this.error,this),this.debugFormat=__bind(this.debugFormat,this),this.debug=__bind(this.debug,this),this._log=__bind(this._log,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="logProvider",t.prototype._log=function(){var e,t,n;if(arguments.length===2){t=arguments[0],n=arguments[1],this.isEnabled(t)&&this.log(t,n);return}arguments.length===3&&(t=arguments[0],n=arguments[1],e=arguments[2],this.isEnabled(t)&&this.log(t,n,e))},t.prototype.debug=function(){var e,t;if(arguments.length===2){t=arguments[0],e=arguments[1],this._log(fm.logLevel.Debug,t,e);return}arguments.length===1&&(t=arguments[0],this._log(fm.logLevel.Debug,t))},t.prototype.debugFormat=function(){var e,t;arguments.length===2&&(t=arguments[0],e=arguments[1],this.debug(fm.stringExtensions.format(t,e)))},t.prototype.error=function(){var e,t;if(arguments.length===2){t=arguments[0],e=arguments[1],this._log(fm.logLevel.Error,t,e);return}arguments.length===1&&(t=arguments[0],this._log(fm.logLevel.Error,t))},t.prototype.errorFormat=function(){var e,t;arguments.length===2&&(t=arguments[0],e=arguments[1],this.error(fm.stringExtensions.format(t,e)))},t.prototype.fatal=function(){var e,t;if(arguments.length===1){t=arguments[0],this._log(fm.logLevel.Fatal,t);return}arguments.length===2&&(t=arguments[0],e=arguments[1],this._log(fm.logLevel.Fatal,t,e))},t.prototype.fatalFormat=function(){var e,t;arguments.length===2&&(t=arguments[0],e=arguments[1],this.fatal(fm.stringExtensions.format(t,e)))},t.prototype.getIsDebugEnabled=function(){if(arguments.length===0)return this.isEnabled(fm.logLevel.Debug)},t.prototype.getIsErrorEnabled=function(){if(arguments.length===0)return this.isEnabled(fm.logLevel.Error)},t.prototype.getIsFatalEnabled=function(){if(arguments.length===0)return this.isEnabled(fm.logLevel.Fatal)},t.prototype.getIsInfoEnabled=function(){if(arguments.length===0)return this.isEnabled(fm.logLevel.Info)},t.prototype.getIsWarnEnabled=function(){if(arguments.length===0)return this.isEnabled(fm.logLevel.Warn)},t.prototype.info=function(){var e,t;if(arguments.length===1){t=arguments[0],this._log(fm.logLevel.Info,t);return}arguments.length===2&&(t=arguments[0],e=arguments[1],this._log(fm.logLevel.Info,t,e))},t.prototype.infoFormat=function(){var e,t;arguments.length===2&&(t=arguments[0],e=arguments[1],this.info(fm.stringExtensions.format(t,e)))},t.prototype.isEnabled=function(){var e;arguments.length===1&&(e=arguments[0])},t.prototype.log=function(){var e,t,n;if(arguments.length===3){t=arguments[0],n=arguments[1],e=arguments[2];return}arguments.length===2&&(t=arguments[0],n=arguments[1])},t.prototype.warn=function(){var e,t;if(arguments.length===2){t=arguments[0],e=arguments[1],this._log(fm.logLevel.Warn,t,e);return}arguments.length===1&&(t=arguments[0],this._log(fm.logLevel.Warn,t))},t.prototype.warnFormat=function(){var e,t;arguments.length===2&&(t=arguments[0],e=arguments[1],this.warn(fm.stringExtensions.format(t,e)))},t}(fm.object),fm.nullLogProvider=function(e){function t(){this.log=__bind(this.log,this),this.isEnabled=__bind(this.isEnabled,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="nullLogProvider",t.prototype.isEnabled=function(){var e;if(arguments.length===1)return e=arguments[0],!1},t.prototype.log=function(){var e,t,n;if(arguments.length===2){t=arguments[0],n=arguments[1];return}arguments.length===3&&(t=arguments[0],n=arguments[1],e=arguments[2])},t}(fm.logProvider),fm.serializer=function(e){function t(){if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="serializer",t.charToUnicodeString=function(){var e,t,n,r,i;if(arguments.length===1)return i=arguments[0],e=fm.serializer.intToHex(i>>12&""),t=fm.serializer.intToHex(i>>8&""),n=fm.serializer.intToHex(i>>4&""),r=fm.serializer.intToHex(i&""),fm.stringExtensions.concat(["\\u",e,t,n,r])},t.deserializeBoolean=function(){var e,t,n,r;if(arguments.length===1){t=arguments[0];if(!fm.stringExtensions.isNullOrEmpty(t)){t=fm.stringExtensions.trim(t);if(t==="null")return null;e=!1,n=new fm.holder(e),r=fm.parseAssistant.tryParseBoolean(t,n),e=n.getValue();if(r)return e}return null}},t.deserializeBooleanArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;t=null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))t=[];else{r=fm.stringExtensions.split(e,[","]),t=[],n=0;while(n<r.length)t[n]=fm.serializer.deserializeBoolean(fm.stringExtensions.trim(r[n])),n++}}return t}},t.deserializeDecimal=function(){var e,t,n,r;if(arguments.length===1){t=arguments[0];if(!fm.stringExtensions.isNullOrEmpty(t)){t=fm.stringExtensions.trim(t);if(t==="null")return null;e=0,n=new fm.holder(e),r=fm.parseAssistant.tryParseDecimal(t,n),e=n.getValue();if(r)return e}return null}},t.deserializeDecimalArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;n=null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))n=[];else{r=fm.stringExtensions.split(e,[","]),n=[],t=0;while(t<r.length)n[t]=fm.serializer.deserializeDecimal(fm.stringExtensions.trim(r[t])),t++}}return n}},t.deserializeDouble=function(){var e,t,n,r;if(arguments.length===1){t=arguments[0];if(!fm.stringExtensions.isNullOrEmpty(t)){t=fm.stringExtensions.trim(t);if(t==="null")return null;e=0,n=new fm.holder(e),r=fm.parseAssistant.tryParseDouble(t,n),e=n.getValue();if(r)return e}return null}},t.deserializeDoubleArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;n=null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))n=[];else{r=fm.stringExtensions.split(e,[","]),n=[],t=0;while(t<r.length)n[t]=fm.serializer.deserializeDouble(fm.stringExtensions.trim(r[t])),t++}}return n}},t.deserializeFloat=function(){var e,t,n,r;if(arguments.length===1){t=arguments[0];if(!fm.stringExtensions.isNullOrEmpty(t)){t=fm.stringExtensions.trim(t);if(t==="null")return null;e=0,n=new fm.holder(e),r=fm.parseAssistant.tryParseFloat(t,n),e=n.getValue();if(r)return e}return null}},t.deserializeFloatArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;n=null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))n=[];else{r=fm.stringExtensions.split(e,[","]),n=[],t=0;while(t<r.length)n[t]=fm.serializer.deserializeFloat(fm.stringExtensions.trim(r[t])),t++}}return n}},t.deserializeGuid=function(){var e,t,n,r;if(arguments.length===1){t=arguments[0];if(!fm.stringExtensions.isNullOrEmpty(t)){t=fm.stringExtensions.trim(t);if(t==="null")return null;e=fm.guid.empty,n=new fm.holder(e),r=fm.parseAssistant.tryParseGuid(fm.serializer.deserializeString(t),n),e=n.getValue();if(r)return e}return null}},t.deserializeGuidArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;t=null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))t=[];else{r=fm.stringExtensions.split(e,[","]),t=[],n=0;while(n<r.length)t[n]=fm.serializer.deserializeGuid(fm.stringExtensions.trim(r[n])),n++}}return t}},t.deserializeInteger=function(){var e,t,n,r;if(arguments.length===1){t=arguments[0];if(!fm.stringExtensions.isNullOrEmpty(t)){t=fm.stringExtensions.trim(t);if(t==="null")return null;e=0,n=new fm.holder(e),r=fm.parseAssistant.tryParseInteger(t,n),e=n.getValue();if(r)return e}return null}},t.deserializeIntegerArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;n=null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))n=[];else{r=fm.stringExtensions.split(e,[","]),n=[],t=0;while(t<r.length)n[t]=fm.serializer.deserializeInteger(fm.stringExtensions.trim(r[t])),t++}}return n}},t.deserializeLong=function(){var e,t,n,r;if(arguments.length===1){t=arguments[0];if(!fm.stringExtensions.isNullOrEmpty(t)){t=fm.stringExtensions.trim(t);if(t==="null")return null;e=0,n=new fm.holder(e),r=fm.parseAssistant.tryParseLong(t,n),e=n.getValue();if(r)return e}return null}},t.deserializeLongArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;n=null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))n=[];else{r=fm.stringExtensions.split(e,[","]),n=[],t=0;while(t<r.length)n[t]=fm.serializer.deserializeLong(fm.stringExtensions.trim(r[t])),t++}}return n}},t.deserializeObject=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;if(arguments.length===3){u=arguments[0],n=arguments[1],e=arguments[2],y=u;if(y===null||typeof y=="undefined")return null;u=fm.stringExtensions.trim(u);if(u==="null"||u.length<2)return null;v=n();if(u.charAt(0)==="{"&&u.charAt(u.length-1)==="}"&&u.length>2){u=fm.stringExtensions.concat(fm.stringExtensions.substring(u,1,u.length-2),","),f=0,l=0,r=!1,c=-2,a=fm.stringType.None,p=0,h=0,g=fm.stringExtensions.empty,d=fm.stringExtensions.empty,o=0;while(o<u.length){t=u.charAt(o),i=c===o-1,s=!1;if(!r)switch(t){case"[":l++,s=!0;break;case"]":l--,s=!0;break;case"{":f++,s=!0;break;case"}":f--,s=!0}if(!s){r&&t==="\\"&&!i&&(c=o,s=!0);if(!s){if(f===0&&l===0)switch(t){case",":r||(d=fm.stringExtensions.trim(fm.stringExtensions.substring(u,h,o-h)),e(v,fm.serializer.deserializeString(g),d),p=o+1),s=!0;break;case":":r||(g=fm.stringExtensions.trim(fm.stringExtensions.substring(u,p,o-p)),h=o+1),s=!0}!s&&(t==="'"||t==='"')&&!i&&(m=t==='"'?fm.stringType.Double:fm.stringType.Single,r?a===m&&(r=!1,a=fm.stringType.None):(r=!0,a=m),s=!0)}}o++}}return v}},t.deserializeObjectArray=function(){var e,t,n,r,i,s,o,u,a,f,l;if(arguments.length===3){r=arguments[0],t=arguments[1],e=arguments[2],i=fm.serializer.deserializeRawArray(r),f=i;if(f===null||typeof f=="undefined")return null;s=[],l=i;for(u=0,a=l.length;u<a;u++)o=l[u],n=fm.serializer.deserializeObject(o,t,e),fm.arrayExtensions.add(s,n);return s}},t.deserializeObjectArrayFast=function(){var e,t,n,r,i,s,o,u,a,f,l;if(arguments.length===3){r=arguments[0],t=arguments[1],e=arguments[2],i=fm.serializer.deserializeRawArray(r),f=i;if(f===null||typeof f=="undefined")return null;s=[],l=i;for(u=0,a=l.length;u<a;u++)o=l[u],n=fm.serializer.deserializeObject(o,t,e),n.setSerialized(o),fm.arrayExtensions.add(s,n);return s}},t.deserializeObjectFast=function(){var e,t,n,r,i;if(arguments.length===3)return n=arguments[0],t=arguments[1],e=arguments[2],r=fm.serializer.deserializeObject(n,t,e),i=r,i!==null&&typeof i!="undefined"&&r.setSerialized(n),r},t.deserializeRaw=function(){var e;if(arguments.length===1)return e=arguments[0],fm.stringExtensions.isNullOrEmpty(e)?null:fm.stringExtensions.trim(e)},t.deserializeRawArray=function(){var e,t,n,r,i,s,o,u,a,f,l,c;if(arguments.length===1){i=arguments[0],c=i;if(c===null||typeof c=="undefined")return null;i=fm.stringExtensions.trim(i);if(i==="null"||i.length<2)return null;s=[];if(i.charAt(0)==="["&&i.charAt(i.length-1)==="]"&&i.length>2){u=0,f=0,t=!1,a=-2,o=fm.stringType.None,r=1;while(r<i.length-1){e=i.charAt(r),n=a===r-1;if(!t)switch(e){case"{":u===0&&(f=r),u++;break;case"}":u--,u===0&&fm.arrayExtensions.add(s,fm.stringExtensions.substring(i,f,r-f+1))}t&&e==="\\"&&!n?a=r:(e==="'"||e==='"')&&!n&&(l=e==='"'?fm.stringType.Double:fm.stringType.Single,t?o===l&&(t=!1,o=fm.stringType.None):(t=!0,o=l)),r++}}return s}},t.deserializeString=function(){var e;if(arguments.length===1)return e=arguments[0],fm.stringExtensions.isNullOrEmpty(e)?null:(e=fm.stringExtensions.trim(e),e==="null"?null:fm.serializer.unescapeString(fm.serializer.trimQuotes(e)))},t.deserializeStringArray=function(){var e,t,n;if(arguments.length===1){e=arguments[0];if(fm.stringExtensions.isNullOrEmpty(e))return null;e=fm.stringExtensions.trim(e);if(e==="null")return null;if(e.charAt(0)==="["){e=fm.stringExtensions.substring(e,1,e.length-2);if(fm.stringExtensions.isNullOrEmpty(e))n=[];else{n=fm.stringExtensions.split(e,[","]),t=0;while(t<n.length)n[t]=fm.serializer.unescapeString(fm.serializer.trimQuotes(fm.stringExtensions.trim(n[t]))),t++}return n}return[e]}},t.escapeString=function(){var e,t,n,r,i;if(arguments.length===1){r=arguments[0],t=0;while(t<r.length){e=r.charAt(t);if(e>"~"){r=fm.stringExtensions.concat(fm.stringExtensions.substring(r,0,t),fm.serializer.charToUnicodeString(e),r.substring(t+1)),t+=5;continue}switch(e){case"/":n="\\/";break;case"\\":n="\\\\";break;case"\b":n="\\b";break;case"	":n="\\t";break;case"\n":n="\\n";break;case"\f":n="\\f";break;case"\r":n="\\r";break;case'"':n='\\"';break;default:n=null}i=n,i!==null&&typeof i!="undefined"&&(r=fm.stringExtensions.concat(fm.stringExtensions.substring(r,0,t),n,r.substring(t+1)),t++),t++}return r}},t.intToHex=function(){var e;if(arguments.length===1)return e=arguments[0],e<=9?e+48:e-10+97},t.isValidJson=function(){var e;if(arguments.length===1)return e=arguments[0],(new fm.jsonChecker).checkString(e)},t.serializeBoolean=function(){var e;if(arguments.length===1)return e=arguments[0],e===null?"null":e?"true":"false"},t.serializeBooleanArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeBoolean(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.serializeDecimal=function(){var e;if(arguments.length===1)return e=arguments[0],e===null?"null":e.toString()},t.serializeDecimalArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeDecimal(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.serializeDouble=function(){var e;if(arguments.length===1)return e=arguments[0],e===null?"null":e.toString()},t.serializeDoubleArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeDouble(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.serializeFloat=function(){var e;if(arguments.length===1)return e=arguments[0],e===null?"null":e.toString()},t.serializeFloatArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeFloat(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.serializeGuid=function(){var e;if(arguments.length===1)return e=arguments[0],e===null?"null":fm.stringExtensions.concat('"',e.toString(),'"')},t.serializeGuidArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeGuid(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.serializeInteger=function(){var e;if(arguments.length===1)return e=arguments[0],e===null?"null":fm.intExtensions.toString(e)},t.serializeIntegerArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeInteger(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.serializeLong=function(){var e;if(arguments.length===1)return e=arguments[0],e===null?"null":fm.intExtensions.toString(e)},t.serializeLongArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeLong(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.serializeObject=function(){var e,t,n,r,i,s,o,u,a;if(arguments.length===2){r=arguments[0],e=arguments[1],u=r;if(u===null||typeof u=="undefined")return"null";t={},e(r,t),n=[],a=fm.hashExtensions.getKeys(t);for(s=0,o=a.length;s<o;s++)i=a[s],fm.arrayExtensions.add(n,fm.stringExtensions.concat(fm.serializer.serializeString(i),":",t[i]));return fm.stringExtensions.concat("{",fm.stringExtensions.join(",",fm.arrayExtensions.toArray(n)),"}")}},t.serializeObjectArray=function(){var e,t,n,r,i;if(arguments.length===2){n=arguments[0],e=arguments[1],i=n;if(i===null||typeof i=="undefined")return"null";if(n.length===0)return"[]";r=[],t=0;while(t<n.length)r[t]=fm.serializer.serializeObject(n[t],e),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",r),"]")}},t.serializeObjectArrayFast=function(){var e,t,n,r,i;if(arguments.length===2){n=arguments[0],e=arguments[1],i=n;if(i===null||typeof i=="undefined")return"null";if(n.length===0)return"[]";r=[],t=0;while(t<n.length)r[t]=fm.serializer.serializeObjectFast(n[t],e),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",r),"]")}},t.serializeObjectFast=function(){var e,t,n;if(arguments.length===2)return t=arguments[0],e=arguments[1],n=t,n===null||typeof n=="undefined"?"null":((!t.getIsSerialized()||!!t.getIsDirty())&&t.setSerialized(fm.serializer.serializeObject(t,e)),t.getSerialized())},t.serializeRaw=function(){var e;if(arguments.length===1)return e=arguments[0],e},t.serializeRawArray=function(){var e,t;if(arguments.length===1)return e=arguments[0],t=e,t===null||typeof t=="undefined"?"null":fm.stringExtensions.concat("[",fm.stringExtensions.join(",",e),"]")},t.serializeString=function(){var e,t;if(arguments.length===1)return e=arguments[0],t=e,t===null||typeof t=="undefined"?"null":fm.stringExtensions.concat('"',fm.serializer.escapeString(e),'"')},t.serializeStringArray=function(){var e,t,n,r;if(arguments.length===1){e=arguments[0],r=e;if(r===null||typeof r=="undefined")return"null";n=[],t=0;while(t<e.length)n[t]=fm.serializer.serializeString(e[t]),t++;return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")}},t.trimQuotes=function(){var e,t,n;if(arguments.length===1)return n=arguments[0],n.length>1&&(e=n.charAt(0),t=n.charAt(n.length-1),e===t&&(e==="'"||e==='"')&&(n=fm.stringExtensions.substring(n,1,n.length-2))),n},t.unescapeString=function(){var e,t,n,r,i,s;if(arguments.length===1){s=arguments[0],r=0;while(r<s.length){e=s.charAt(r);if(e==="\\"&&r!==s.length-1){t=s.charAt(r+1),i=2;switch(t){case"r":n="\r";break;case"t":n="	";break;case"u":n=t,r<s.length-5&&(n=fm.serializer.unicodeStringToChar(fm.stringExtensions.substring(s,r,6)),i=6);break;case"x":n=t,r<s.length-3&&(n=fm.serializer.unicodeStringToChar(fm.stringExtensions.substring(s,r,4)),i=4);break;case"n":n="\n";break;case"f":n="\f";break;case"/":n="/";break;case"b":n="\b";break;default:n=t}s=fm.stringExtensions.concat(fm.stringExtensions.substring(s,0,r),n.toString(),s.substring(r+i))}r++}return s}},t.unicodeStringToChar=function(){var e;if(arguments.length===1){e=arguments[0];if(e.length<2)throw new Error("Unicode string has invalid length.");return fm.convert.toInt32(e.substring(2),16)}},t}.call(this,fm.object),fm.jsonChecker=function(e){function t(){this.push=__bind(this.push,this),this.pop=__bind(this.pop,this),this.onError=__bind(this.onError,this),this.finalCheck=__bind(this.finalCheck,this),this.checkString=__bind(this.checkString,this),this.check=__bind(this.check,this);var e;if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.call(this,0);return}if(arguments.length===1){e=arguments[0],t.__super__.constructor.call(this);if(e<0)throw new Error("depth");this.__state=0,this.__depth=e,this.__stack=new fm.stack(e),this.push(fm.jsonCheckerMode.Done);return}}return __extends(t,e),t.name="jsonChecker",t.prototype.__depth=0,t.prototype.__offset=0,t.prototype.__stack=null,t.prototype.__state=0,t._ascii_class=null,t._state_transition_table=null,t.prototype.check=function(){var e,t,n,r;arguments.length===1&&(e=arguments[0],e<0&&this.onError(),e>=128?n=30:(n=fm.jsonChecker._ascii_class[e],n<=-1&&this.onError()),r=fm.jsonChecker._state_transition_table[this.__state][n],r>=0?(this.__state=r,this.__offset=this.__offset+1):(r===-9?(this.pop(fm.jsonCheckerMode.Key),this.__state=1):r===-8?(this.pop(fm.jsonCheckerMode.Object),this.__state=1):r===-7?(this.pop(fm.jsonCheckerMode.Array),this.__state=1):r===-6?(this.push(fm.jsonCheckerMode.Key),this.__state=2):r===-5?(this.push(fm.jsonCheckerMode.Array),this.__state=6):r===-4?(t=this.__stack.peek(),t===fm.jsonCheckerMode.Key?this.__state=4:t===fm.jsonCheckerMode.Array||t===fm.jsonCheckerMode.Object?this.__state=1:t===fm.jsonCheckerMode.Done?(this.push(fm.jsonCheckerMode.String),this.__state=7):t===fm.jsonCheckerMode.String?(this.pop(fm.jsonCheckerMode.String),this.__state=1):this.onError()):r===-3?(t=this.__stack.peek(),t===fm.jsonCheckerMode.Object?(this.pop(fm.jsonCheckerMode.Object),this.push(fm.jsonCheckerMode.Key),this.__state=3):t===fm.jsonCheckerMode.Array?this.__state=5:this.onError()):r===-2?(this.pop(fm.jsonCheckerMode.Key),this.push(fm.jsonCheckerMode.Object),this.__state=5):this.onError(),this.__offset=this.__offset+1))},t.prototype.checkString=function(){var e,t,n,r,i,s,o,u;if(arguments.length===1){r=arguments[0],t=0,e=0,i=new fm.holder(t),s=fm.parseAssistant.tryParseDouble(r,i),t=i.getValue(),o=new fm.holder(e),u=fm.parseAssistant.tryParseDecimal(r,o),e=o.getValue();if(r==="true"||r==="false"||r==="null"||s||u)return!0;try{n=0;while(n<r.length)this.check(fm.convert.toInt32(r.charAt(n))),n++;return this.finalCheck(),!0}catch(a){return!1}finally{}}},t.prototype.finalCheck=function(){arguments.length===0&&(this.__state!==1&&this.onError(),this.pop(fm.jsonCheckerMode.Done))},t.prototype.onError=function(){if(arguments.length===0)throw new Error(fm.stringExtensions.format("Invalid JSON text at character offset {0}.",fm.intExtensions.toString(this.__offset,"N0")))},t.prototype.pop=function(){var e;arguments.length===1&&(e=arguments[0],this.__stack.pop()!==e&&this.onError())},t.prototype.push=function(){var e;arguments.length===1&&(e=arguments[0],this.__depth>0&&this.__stack.getCount()>=this.__depth&&this.onError(),this.__stack.push(e))},t._ascii_class=[-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,30,8,30,30,30,30,30,30,30,30,11,7,12,13,10,14,15,15,15,15,15,15,15,15,15,6,30,30,30,30,30,30,28,28,28,28,29,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,4,9,5,30,30,30,16,17,18,19,20,21,30,30,30,30,30,22,30,23,30,30,30,24,25,26,27,30,30,30,30,30,2,30,3,30,30],t._state_transition_table=[[0,0,-6,-1,-5,-1,-1,-1,-4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,-1,-8,-1,-7,-1,-3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[2,2,-1,-9,-1,-1,-1,-1,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[3,3,-1,-1,-1,-1,-1,-1,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[4,4,-1,-1,-1,-1,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[5,5,-6,-1,-5,-1,-1,-1,7,-1,-1,-1,13,-1,14,15,-1,-1,-1,-1,-1,23,-1,27,-1,-1,20,-1,-1,-1,-1],[6,6,-6,-1,-5,-7,-1,-1,7,-1,-1,-1,13,-1,14,15,-1,-1,-1,-1,-1,23,-1,27,-1,-1,20,-1,-1,-1,-1],[7,-1,7,7,7,7,7,7,-4,8,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[-1,-1,-1,-1,-1,-1,-1,-1,7,7,7,-1,-1,-1,-1,-1,-1,7,-1,-1,-1,7,-1,7,7,-1,7,9,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,10,10,10,10,10,10,10,-1,-1,-1,-1,-1,-1,10,10,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,11,11,11,11,11,11,11,-1,-1,-1,-1,-1,-1,11,11,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12,12,12,12,12,12,12,12,-1,-1,-1,-1,-1,-1,12,12,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,7,7,7,7,7,7,7,-1,-1,-1,-1,-1,-1,7,7,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,-1,-8,-1,-7,-1,-3,-1,-1,-1,-1,-1,16,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,-1,-8,-1,-7,-1,-3,-1,-1,-1,-1,-1,16,15,15,-1,-1,-1,-1,17,-1,-1,-1,-1,-1,-1,-1,-1,17,-1],[1,1,-1,-8,-1,-7,-1,-3,-1,-1,-1,-1,-1,-1,16,16,-1,-1,-1,-1,17,-1,-1,-1,-1,-1,-1,-1,-1,17,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,18,18,-1,19,19,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,19,19,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,-1,-8,-1,-7,-1,-3,-1,-1,-1,-1,-1,-1,19,19,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,22,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,25,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,26,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,28,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1]],t}(fm.object),fm.httpRequestCreatedArgs=function(e){function t(){this.setSender=__bind(this.setSender,this),this.setRequestArgs=__bind(this.setRequestArgs,this),this.setRequest=__bind(this.setRequest,this),this.getSender=__bind(this.getSender,this),this.getRequestArgs=__bind(this.getRequestArgs,this),this.getRequest=__bind(this.getRequest,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="httpRequestCreatedArgs",t.prototype._request=null,t.prototype._requestArgs=null,t.prototype._sender=null,t.prototype.getRequest=function(){if(arguments.length===0)return this._request},t.prototype.getRequestArgs=function(){if(arguments.length===0)return this._requestArgs},t.prototype.getSender=function(){if(arguments.length===0)return this._sender},t.prototype.setRequest=function(){var e;arguments.length===1&&(e=arguments[0],this._request=e)},t.prototype.setRequestArgs=function(){var e;arguments.length===1&&(e=arguments[0],this._requestArgs=e)},t.prototype.setSender=function(){var e;arguments.length===1&&(e=arguments[0],this._sender=e)},t}(fm.object),fm.httpResponseReceivedArgs=function(e){function t(){this.setSender=__bind(this.setSender,this),this.setResponse=__bind(this.setResponse,this),this.setRequestArgs=__bind(this.setRequestArgs,this),this.getSender=__bind(this.getSender,this),this.getResponse=__bind(this.getResponse,this),this.getRequestArgs=__bind(this.getRequestArgs,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="httpResponseReceivedArgs",t.prototype._requestArgs=null,t.prototype._response=null,t.prototype._sender=null,t.prototype.getRequestArgs=function(){if(arguments.length===0)return this._requestArgs},t.prototype.getResponse=function(){if(arguments.length===0)return this._response},t.prototype.getSender=function(){if(arguments.length===0)return this._sender},t.prototype.setRequestArgs=function(){var e;arguments.length===1&&(e=arguments[0],this._requestArgs=e)},t.prototype.setResponse=function(){var e;arguments.length===1&&(e=arguments[0],this._response=e)},t.prototype.setSender=function(){var e;arguments.length===1&&(e=arguments[0],this._sender=e)},t}(fm.object),fm.httpTransfer=function(e){function t(){this.startRequest=__bind(this.startRequest,this),this.shutdown=__bind(this.shutdown,this),this.sendTextAsync=__bind(this.sendTextAsync,this),this.sendText=__bind(this.sendText,this),this.sendBinaryAsync=__bind(this.sendBinaryAsync,this),this.sendBinary=__bind(this.sendBinary,this),this.sendAsyncCallback=__bind(this.sendAsyncCallback,this),this.sendAsync=__bind(this.sendAsync,this),this.send=__bind(this.send,this),this.raiseOnSendStart=__bind(this.raiseOnSendStart,this),this.raiseOnSendFinish=__bind(this.raiseOnSendFinish,this),this.finishRequest=__bind(this.finishRequest,this);if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this),this._httpTransferCallbackKey="fm.httpTransfer.callback";return}}return __extends(t,e),t.name="httpTransfer",t.prototype._httpTransferCallbackKey=null,t._onSendFinish=null,t._onSendStart=null,t.addOnSendFinish=function(){var e;arguments.length===1&&(e=arguments[0],fm.httpTransfer._onSendFinish=fm.delegate.combine(fm.httpTransfer._onSendFinish,e))},t.addOnSendStart=function(){var e;arguments.length===1&&(e=arguments[0],fm.httpTransfer._onSendStart=fm.delegate.combine(fm.httpTransfer._onSendStart,e))},t.addQueryToUrl=function(){var e,t,n,r;if(arguments.length===2)return t=arguments[0],e=arguments[1],fm.httpTransfer.addQueryToUrl(t,e,null);if(arguments.length===3){t=arguments[0],e=arguments[1],n=arguments[2];if(fm.stringExtensions.isNullOrEmpty(e))return t;r=n;if(r===null||typeof r=="undefined")n=fm.stringExtensions.empty;return e=fm.uri.escapeDataString(e),n=fm.uri.escapeDataString(n),fm.stringExtensions.concat([t,fm.stringExtensions.indexOf(t,"?",fm.stringComparison.OrdinalIgnoreCase)===-1?"?":"&",e,"=",n])}},t.removeOnSendFinish=function(){var e;arguments.length===1&&(e=arguments[0],fm.httpTransfer._onSendFinish=fm.delegate.remove(fm.httpTransfer._onSendFinish,e))},t.removeOnSendStart=function(){var e;arguments.length===1&&(e=arguments[0],fm.httpTransfer._onSendStart=fm.delegate.remove(fm.httpTransfer._onSendStart,e))},t.prototype.finishRequest=function(){var e,t,n,r,i,s,o,u,a,f;if(arguments.length===1){r=arguments[0],o=r.getException();if(o!==null&&typeof o!="undefined"){t=fm.global.tryCast(r.getException(),Error),u=t;if(u!==null&&typeof u!="undefined")try{a=t.getResponse();if(a!==null&&typeof a!="undefined"){s=t.getResponse().getResponseStream();try{n=new fm.streamReader(s);try{i=n.readToEnd(),fm.stringExtensions.isNullOrEmpty(i)||r.setException(new Error(i,t,t.getStatus(),t.getResponse()))}finally{n.close()}}finally{s.close()}}}catch(l){}finally{}else{e=fm.global.tryCast(r.getException(),Error),f=e;if(f!==null&&typeof f!="undefined")try{r.setException(new Error("Security error (possible cross-domain restrictions).",e))}catch(c){r.setException(e)}finally{}}}this.raiseOnSendFinish(r)}},t.prototype.raiseOnSendFinish=function(){var e,t,n,r;arguments.length===1&&(n=arguments[0],e=fm.httpTransfer._onSendFinish,r=e,r!==null&&typeof r!="undefined"&&(t=new fm.httpSendFinishArgs,t.setSender(n.getRequestArgs().getSender()),t.setRequestBinaryContent(n.getRequestArgs().getBinaryContent()),t.setRequestTextContent(n.getRequestArgs().getTextContent()),t.setResponseBinaryContent(n.getBinaryContent()),t.setResponseTextContent(n.getTextContent()),t.setResponseHeaders(n.getHeaders()),e(t)))},t.prototype.raiseOnSendStart=function(){var e,t,n,r;arguments.length===1&&(n=arguments[0],e=fm.httpTransfer._onSendStart,r=e,r!==null&&typeof r!="undefined"&&(t=new fm.httpSendStartArgs,t.setSender(n.getSender()),t.setRequestBinaryContent(n.getBinaryContent()),t.setRequestTextContent(n.getTextContent()),e(t)))},t.prototype.send=function(){var e,t,n,r;if(arguments.length===1){n=arguments[0],this.startRequest(n);try{r=n.getBinaryContent(),r!==null&&typeof r!="undefined"?e=this.sendBinary(n):e=this.sendText(n)}catch(i){t=new fm.httpResponseArgs(n),t.setException(i),e=t}finally{}return this.finishRequest(e),e}},t.prototype.sendAsync=function(){var e,t,n,r;if(arguments.length===2){n=arguments[0],e=arguments[1],this.startRequest(n),n.setDynamicValue(this._httpTransferCallbackKey,e);try{r=n.getBinaryContent(),r!==null&&typeof r!="undefined"?this.sendBinaryAsync(n,this.sendAsyncCallback):this.sendTextAsync(n,this.sendAsyncCallback)}catch(i){t=new fm.httpResponseArgs(n),t.setException(i),e(t)}finally{}}},t.prototype.sendAsyncCallback=function(){var e,t;arguments.length===1&&(t=arguments[0],e=t.getRequestArgs().getDynamicValue(this._httpTransferCallbackKey),this.finishRequest(t),e(t))},t.prototype.sendBinary=function(){var e;arguments.length===1&&(e=arguments[0])},t.prototype.sendBinaryAsync=function(){var e,t;arguments.length===2&&(t=arguments[0],e=arguments[1])},t.prototype.sendText=function(){var e;arguments.length===1&&(e=arguments[0])},t.prototype.sendTextAsync=function(){var e,t;arguments.length===2&&(t=arguments[0],e=arguments[1])},t.prototype.shutdown=function(){arguments.length===0},t.prototype.startRequest=function(){var e;arguments.length===1&&(e=arguments[0],this.raiseOnSendStart(e))},t}.call(this,fm.object),fm.stringAssistant=function(e){function t(){if(arguments.length===1&&fm.util.isPlainObject(arguments[0])&&fm.util.canAttachProperties(this,arguments[0])){t.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]);return}if(arguments.length===0){t.__super__.constructor.call(this);return}}return __extends(t,e),t.name="stringAssistant",t.subArray=function(){var e,t,n,r,i;if(arguments.length===2)return e=arguments[0],r=arguments[1],fm.stringAssistant.subArray(e,r,e.length-r);if(arguments.length===3){e=arguments[0],r=arguments[1],t=arguments[2],i=[],n=0;while(n<t)i[n]=e[r+n],n++;return i}},t}.call(this,fm.object);var __bind=function(e,t){return function(){return e.apply(t,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};fm.httpWebRequestTransfer=function(e){function t(){return this.sendInternal=__bind(this.sendInternal,this),this.process=__bind(this.process,this),this.sendText=__bind(this.sendText,this),this.sendTextAsync=__bind(this.sendTextAsync,this),t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.name="httpWebRequestTransfer",t._corsFailCache={},t._pmFailCache={},t.getPlatformCode=function(){return"js"},t.setDisableCORS=function(e){return t._disableCORS=e},t.getDisableCORS=function(){return t._disableCORS||!1},t.setDisablePostMessage=function(e){return t._disablePostMessage=e},t.getDisablePostMessage=function(){return t._disablePostMessage||!1},t.setForceJSONP=function(e){return t._forceJSONP=e},t.getForceJSONP=function(){return t._forceJSONP||!1},t.prototype.sendTextAsync=function(e,t){var n=this;return fm.util.addOnLoad(function(){return n.process(e,t)})},t.prototype.sendText=function(e){return this.process(e,null)},t.prototype.process=function(e,t){var n,r,i,s,o,u,a,f;return u=fm.httpWebRequestTransfer,f=e.getUrl(),e._processed||(f=fm.util.absolutizeUrl(f),e.setUrl(f),e._processed=!0),r=u.getDisableCORS()||e.getSender().getDisableCORS(),i=u.getDisablePostMessage()||e.getSender().getDisablePostMessage(),o=u.getForceJSONP()||e.getSender().getForceJSONP(),s=fm.xhr.send,n=!1,a=!1,fm.util.isXD(f)&&(!r&&u.canCORS()&&!u._corsFailCache[f]?n=!0:!i&&u.canPostMessage()&&!u._pmFailCache[f]?(a=!0,s=fm.postMessage.send):s=fm.jsonp.send),o&&(s=fm.jsonp.send),this.sendInternal(s,n,a,e,t)},t.prototype.sendInternal=function(e,t,n,r,i){var s,o,u,a,f,l=this;a=this,u=new fm.httpResponseArgs(r),u.setException(new Error("Environment does not support synchronous requests.")),f=r.getUrl(),s="GET";switch(r.getMethod()){case fm.httpMethod.Put:s="PUT";break;case fm.httpMethod.Post:s="POST";break;case fm.httpMethod.Delete:s="DELETE"}return o={sync:i?!1:!0,url:f,method:s,content:r.getTextContent(),headers:r.getHeaders().toHash(),timeout:r.getTimeout(),robustResponse:!0,onRequestCreated:function(e){var t,n;n=r.getOnRequestCreated();if(n)return t=new fm.httpRequestCreatedArgs,t.setRequestArgs(r),t.setSender(r.getSender()),t.setRequest(e),n(t)},onResponseReceived:function(e){var t,n;n=r.getOnResponseReceived();if(n)return t=new fm.httpResponseReceivedArgs,t.setRequestArgs(r),t.setSender(r.getSender()),t.setResponse(e),n(t)},onSuccess:function(e){if(e.statusCode===0&&t){fm.httpWebRequestTransfer._corsFailCache[f]=!0,i?a.sendTextAsync(r,i):u=a.sendText(r);return}u.setException(null),u.setTextContent(e.content),u.setStatusCode(e.statusCode),u.setHeaders(new fm.nameValueCollection(e.headers));if(i)return i(u)},onFailure:function(e){var s;if(t){fm.httpWebRequestTransfer._corsFailCache[f]=!0,i?a.sendTextAsync(r,i):u=a.sendText(r);return}if(n){fm.httpWebRequestTransfer._pmFailCache[f]=!0,i?a.sendTextAsync(r,i):u=a.sendText(r);return}s=new Error(e.message),u.setException(s);if(i)return i(u)}},e(o),u},t.canCORS=function(){return window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest},t.canPostMessage=function(){return fm.util.isIE6()||fm.util.isIE7()?!1:window.postMessage?!0:!1},t}.call(this,fm.httpTransfer)